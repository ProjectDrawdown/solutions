"""Health & Education solution model for Space Cooling Cluster
   Excel filename: CORE_PopulationChange_29Jan2020 (version 1.5).xlsx
   Excel sheet name: SpaceCooling_cluster
"""
import pathlib
import numpy as np
import pandas as pd
import sys
__file__ = 'c:\\Users\\sunishchal.dev\\Documents\\solutions\\solution\\health_and_education\\clusters'
repo_path = str(pathlib.Path(__file__).parents[2])
sys.path.append(repo_path)
# sys.path.append('c:\\Users\\sunishchal.dev\\Documents\\solutions')

from model import advanced_controls as ac
from solution.health_and_education.clusters import cluster_model

DATADIR = pathlib.Path(__file__).parents[0].joinpath('data')
THISDIR = pathlib.Path(__file__).parents[0]

name = 'Health and Education - Space Cooling Cluster'
solution_category = ac.SOLUTION_CATEGORY.REDUCTION 
period_start = 2020
period_end = 2050

# % impact of educational attainment on uptake of Family Planning:
assumptions = {
    'fixed_weighting_factor': None,
    'pct_impact': 0.50,
    'use_fixed_weight': 'N',
    'Twh_per_TWh': 0.27027027027,
    'TJ_per_TWh': 1403.3616727979,
    'period_start': 2020,
    'period_end': 2050,
    'Grid': 'Y',
    'Fuel': 'N',
    'Other Direct': 'N',
    'Indirect': 'N',
    'Weighted Emission Factor for Space Heating and Cooling': 87.04
}

# TABLE 1: Current TAM Mix
current_tam_mix_list = [
        ['Energy Source', 'Weighting Factor', 'Include in SOL?', 'Include in CONV?'],
        ['Electricity', 95.0, 'N', 'Y']]

# Table 2: REF2,  Heating Demand TAM (TWh Therms)										
# SpaceCooling_cluster!B28:K75
# TODO: Replace this with solarpvutil.Scenario.ref_tam_per_region once we resolve the data mismatch
ref2_tam_list = [
        ['World', 'OECD90', 'Eastern Europe', 'Asia (Sans Japan)', 'Middle East and Africa', 'Latin America', 'China', 'India', 'EU', 'USA'],
        [9420.048251, 2629.435090, 467.0264956, 3740.718808, 871.7010232, 350.4834273, 2609.230277, 737.6365244, 1087.500722, 1156.635498],
        [9656.209279, 2652.404245, 473.7443788, 3858.486310, 899.4620594, 357.2736655, 2684.721063, 770.0808236, 1095.260534, 1168.600794],
        [9897.405911, 2675.160234, 480.4624485, 3979.795788, 927.8077399, 364.1923378, 2759.244739, 805.7220604, 1103.110215, 1180.687336],
        [10143.55947, 2697.690347, 487.1859992, 4104.575801, 956.8036914, 371.2330824, 2832.802159, 844.5345449, 1111.017055, 1192.880541],
        [10394.56021, 2720.001755, 493.9185571, 4232.712642, 986.5268690, 378.3907265, 2905.344880, 886.4870200, 1118.943754, 1205.176379],
        [10650.26125, 2742.109228, 500.6717256, 4364.064076, 1017.057284, 385.6584651, 2976.798683, 931.5370924, 1126.826499, 1217.563983],
        [10908.46035, 2763.946805, 507.6153027, 4497.255260, 1048.742894, 393.0316435, 3045.999583, 979.9681788, 1134.259567, 1230.079929],
        [11175.39419, 2785.746158, 514.2648785, 4635.981754, 1080.845750, 400.5032807, 3116.262398, 1030.796716, 1142.309180, 1242.587344],
        [11444.80163, 2807.270185, 521.0976734, 4776.443203, 1114.245777, 408.0751816, 3184.279521, 1084.972215, 1149.917341, 1255.224638],
        [11718.80788, 2828.616631, 527.9536403, 4919.873113, 1148.734811, 415.7433958, 3251.183018, 1142.160017, 1157.441819, 1267.930924],
        [11997.47277, 2849.810809, 534.8342118, 5066.267879, 1184.371613, 423.5055455, 3317.009906, 1202.349403, 1164.886672, 1280.686927],
        [12280.84358, 2870.869850, 541.7410576, 5215.614994, 1221.218374, 431.3592584, 3381.792227, 1265.527845, 1172.254605, 1293.477706],
        [12568.92632, 2891.799026, 548.6760480, 5367.873103, 1259.343547, 439.3016208, 3445.541455, 1331.678023, 1179.541693, 1306.297351],
        [12861.71283, 2912.589072, 555.6413602, 5522.989215, 1298.821579, 447.3299061, 3508.263844, 1400.779038, 1186.743373, 1319.145871],
        [13159.22265, 2933.223950, 562.6395920, 5680.927538, 1339.728014, 455.4422613, 3569.982466, 1472.810850, 1193.861660, 1332.021734],
        [13461.47803, 2953.679689, 569.6736677, 5841.652833, 1382.141048, 463.6371519, 3630.723581, 1547.752228, 1200.900149, 1344.925447],
        [13776.64516, 2974.093325, 576.1030058, 6010.154533, 1425.054654, 471.9079223, 3694.950020, 1624.300945, 1208.587942, 1357.672940],
        [14080.29858, 2993.983903, 583.8616610, 6171.317093, 1471.789084, 480.2670008, 3749.362668, 1706.283561, 1214.743813, 1370.815396],
        [14396.88825, 3013.819320, 591.0218940, 6340.178401, 1519.166583, 488.6970717, 3807.292671, 1789.837654, 1221.545638, 1383.797602],
        [14718.28631, 3033.424737, 598.2348567, 6511.669956, 1568.347076, 497.2000621, 3864.328273, 1876.223681, 1228.262046, 1396.809417],
        [15044.51201, 3052.780756, 605.5093718, 6685.747544, 1619.408848, 505.7727659, 3920.498624, 1965.419766, 1234.887254, 1409.858355],
        [15375.58135, 3071.870732, 612.8529516, 6862.367987, 1672.427896, 514.4121698, 3975.827797, 2057.405387, 1241.416439, 1422.949751],
        [15711.50322, 3090.682449, 620.2695466, 7041.487673, 1727.477488, 523.1156788, 4030.332384, 2152.160779, 1247.846849, 1436.086207],
        [16052.28355, 3109.208587, 627.7617459, 7223.066701, 1784.626774, 531.8810400, 4084.020627, 2249.669544, 1254.177458, 1449.265910],
        [16397.93061, 3127.443761, 635.3339739, 7407.069784, 1843.942261, 540.7060191, 4136.896917, 2349.918879, 1260.407096, 1462.484522],
        [16748.45150, 3145.385100, 642.9905562, 7593.464041, 1905.488128, 549.5885093, 4188.960804, 2452.898438, 1266.535231, 1475.735478],
        [17091.97248, 3163.026647, 651.7008234, 7774.673924, 1970.954289, 558.5336453, 4233.554859, 2560.518544, 1272.526768, 1489.291403],
        [17464.12973, 3180.369617, 658.5699365, 7973.274595, 2035.536644, 567.5170124, 4290.652209, 2666.997351, 1278.483420, 1502.320672],
        [17829.28699, 3197.399734, 666.4968113, 8166.600653, 2104.179234, 576.5580150, 4340.284787, 2778.083334, 1284.300566, 1515.657342],
        [18199.31007, 3214.108878, 674.5154003, 8362.139339, 2175.325464, 585.6471742, 4389.114621, 2891.835738, 1290.008739, 1529.027371],
        [18574.18193, 3230.485505, 682.6244180, 8559.835021, 2249.043017, 594.7824181, 4437.146810, 3008.234709, 1295.603500, 1542.435097],
        [18953.88721, 3246.520944, 690.8226691, 8759.632821, 2325.400130, 603.9615041, 4484.381827, 3127.261136, 1301.081773, 1555.884357],
        [19338.41858, 3262.207677, 699.1107351, 8961.482779, 2404.465766, 613.1820255, 4530.817770, 3248.896850, 1306.441952, 1569.377062],
        [19727.76983, 3277.545163, 707.4885610, 9165.335357, 2486.309807, 622.4412734, 4576.443033, 3373.125729, 1311.684897, 1582.914696],
        [20121.92719, 3292.540499, 715.9531831, 9371.135510, 2571.002674, 631.7363101, 4621.235057, 3499.933002, 1316.813108, 1596.500400],
        [20520.87524, 3307.205591, 724.5004991, 9578.826412, 2658.615316, 641.0639922, 4665.164043, 3629.305013, 1321.830570, 1610.137671],
        [20932.29082, 3321.393455, 732.4832549, 9793.377495, 2748.135534, 650.4163569, 4712.641740, 3759.945344, 1326.059117, 1623.645167],
        [21333.10011, 3335.569214, 741.8321878, 9999.662204, 2842.882782, 659.8052001, 4750.349882, 3895.682102, 1331.544345, 1637.578378],
        [21746.36897, 3349.261964, 750.6153558, 10212.70580, 2939.678114, 669.2131671, 4791.594579, 4032.651635, 1336.242131, 1651.385498],
        [22164.38133, 3362.621883, 759.4751181, 10427.41638, 3039.674495, 678.6421668, 4831.900149, 4172.114068, 1340.834901, 1665.256518],
        [22587.10611, 3375.642046, 768.4099106, 10643.72325, 3142.941784, 688.0891864, 4871.220676, 4314.046218, 1345.323486, 1679.197693],
        [23014.52377, 3388.315964, 777.4186819, 10861.56291, 3249.550253, 697.5512374, 4909.525374, 4458.425906, 1349.708850, 1693.213458],
        [23446.63038, 3400.640666, 786.5014000, 11080.88226, 3359.570772, 707.0254478, 4946.802415, 4605.234322, 1353.992610, 1707.305728],
        [23883.44127, 3412.612777, 795.6585368, 11301.64086, 3473.074774, 716.5089254, 4983.067200, 4754.453835, 1358.176320, 1721.473510],
        [24324.98199, 3424.224576, 804.8904396, 11523.80453, 3590.133911, 725.9986410, 5018.352258, 4906.064729, 1362.260876, 1735.714428],
        [24771.28903, 3435.466979, 814.1977203, 11747.34646, 3710.820153, 735.4915272, 5052.706457, 5060.047241, 1366.246934, 1750.024479],
        [25220.53039, 3446.410046, 823.7425644, 11970.98180, 3835.476276, 744.9857938, 5085.063399, 5216.702682, 1370.481990, 1764.446230]]

# GRID EMISSIONS FACTORS: REF Grid EFs kg CO2-eq per kwh									
# Emissions Factors!B11:K57
# TODO: Replace this with emissions_factors module once interface is better understood
ef_co2_eq_list = [
        ['World', 'OECD90', 'Eastern Europe', 'Asia (Sans Japan)', 'Middle East and Africa', 'Latin America', 'China', 'India', 'EU', 'USA'],
        [None, None, None, None, None, None, None, None, None, None],
        [0.617381628, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.613053712, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.605559021, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.599823764, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.596692109, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.592956465, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.589394210, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.585889941, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.582469966, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.579126508, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.576180724, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.572640473, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.569484654, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.566378788, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.563317175, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.560425096, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.557305440, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.554345365, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.551409592, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.548493724, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.545513743, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.542688056, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.539794403, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.536903541, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.533998347, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.530880184, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.528185055, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.525268472, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.522337859, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.519390128, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.516316183, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.513431317, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.510414389, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.507368630, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.504753472, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.503017663, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.501095098, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.499244741, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.497355610, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.495425752, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.493412239, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.491436597, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.489373931, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.487263794, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.485104746, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666], 
        [0.483057065, 0.454068989, 0.724747956, 0.457658947, 0.282243907, 0.564394712, 0.535962403, 0.787832379, 0.360629290, 0.665071666]]

class Cluster:

    def __init__(self):
        self.name = name

    def run_cluster(self):
        scenario = cluster_model.Scenario(name, assumptions)
        scenario.load_pop_data(DATADIR)
        scenario.load_tam_mix(current_tam_mix_list)
        scenario.load_ref2_tam(ref2_tam_list)
        scenario.calc_ref1_tam()
        scenario.calc_ref2_demand()
        scenario.calc_ref1_demand()
        scenario.calc_change_demand()
        scenario.calc_addl_units_highed()
        scenario.calc_addl_units_lowed()
        scenario.calc_emis_diff_highed_spacecooling(ef_co2_eq_list)
        scenario.calc_emis_diff_lowed_spacecooling()
        scenario.calc_emis_alloc_lldc()
        scenario.calc_addl_units_mdc()
        scenario.calc_emis_diff_mdc_spacecooling()
        scenario.calc_emis_alloc_mdc()
        scenario.calc_total_emis()
        scenario.print_total_emis()
        return scenario
        
if __name__ == "__main__":
    cluster = Cluster()
    cluster.run_cluster()